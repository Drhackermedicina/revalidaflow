
[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mD:/PROJETOS VS CODE/REVALIDAFLOW/FRONTEND E BACKEND[39m

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mRace Condition Logging[2m > [22m[2mdeve logar race condition prevenida
[22m[39m[2025-11-01T11:11:33.714Z] [INFO] [validation] [RACE_CONDITION] fetchUserRole: Condiâ”œÂºâ”œÃºo de corrida prevenida {
  operationId: [32m'test-op-456'[39m,
  mutexAcquired: [33mtrue[39m,
  sessionId: [32m'validation_1761995493714_gfmjagtts'[39m,
  totalPrevented: [33m1[39m
}

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mFirestore Error Logging[2m > [22m[2mdeve logar recuperaâ”œÂºâ”œÃºo de operaâ”œÂºâ”œÃºo Firestore
[22m[39m[2025-11-01T11:11:33.716Z] [INFO] [validation] [FIRESTORE_RECOVERY] updateDocumentWithRetry: Conexâ”œÃºo recuperada {
  operationId: [32m'firestore-op-456'[39m,
  retryCount: [33m2[39m,
  totalTime: [33m1500[39m,
  sessionId: [32m'validation_1761995493716_5wh49vo3s'[39m,
  totalRecovered: [33m1[39m
}

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mGoogle Auth Logging[2m > [22m[2mdeve logar recuperaâ”œÂºâ”œÃºo de autenticaâ”œÂºâ”œÃºo Google
[22m[39m[2025-11-01T11:11:33.717Z] [INFO] [validation] [GOOGLE_AUTH] processarRedirectResult: Autenticaâ”œÂºâ”œÃºo recuperada {
  redirectId: [32m'redirect-456'[39m,
  method: [32m'redirect'[39m,
  uid: [32m'user-123'[39m,
  sessionId: [32m'validation_1761995493717_5pv3kb911'[39m,
  totalRecovered: [33m1[39m
}

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mGoogle Auth Logging[2m > [22m[2mdeve logar fallback de autenticaâ”œÂºâ”œÃºo Google
[22m[39m[2025-11-01T11:11:33.718Z] [INFO] [validation] [GOOGLE_AUTH] loginComGoogle: Fallback para redirect aplicado {
  loginId: [32m'auth-789'[39m,
  fromMethod: [32m'popup'[39m,
  toMethod: [32m'redirect'[39m,
  sessionId: [32m'validation_1761995493717_sf77m5s8e'[39m,
  totalFallbackRedirects: [33m1[39m
}

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mMetrics Calculation[2m > [22m[2mdeve calcular mâ”œÂ®tricas de race conditions
[22m[39m[2025-11-01T11:11:33.718Z] [INFO] [validation] [RACE_CONDITION] fetchUserRole: Condiâ”œÂºâ”œÃºo de corrida prevenida {
  operationId: [32m'op2'[39m,
  sessionId: [32m'validation_1761995493718_xmevwmt0o'[39m,
  totalPrevented: [33m1[39m
}

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mMetrics Calculation[2m > [22m[2mdeve calcular mâ”œÂ®tricas de Firestore
[22m[39m[2025-11-01T11:11:33.719Z] [INFO] [validation] [FIRESTORE_RECOVERY] getDocumentWithRetry: Conexâ”œÃºo recuperada {
  operationId: [32m'fs2'[39m,
  sessionId: [32m'validation_1761995493719_spo34isb6'[39m,
  totalRecovered: [33m1[39m
}
[2025-11-01T11:11:33.719Z] [INFO] [validation] [FIRESTORE_RECOVERY] getDocumentWithRetry: Conexâ”œÃºo recuperada {
  operationId: [32m'fs3'[39m,
  sessionId: [32m'validation_1761995493719_spo34isb6'[39m,
  totalRecovered: [33m2[39m
}

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mMetrics Calculation[2m > [22m[2mdeve calcular mâ”œÂ®tricas de Google Auth
[22m[39m[2025-11-01T11:11:33.720Z] [INFO] [validation] [GOOGLE_AUTH] loginComGoogle: Autenticaâ”œÂºâ”œÃºo recuperada {
  loginId: [32m'g2'[39m,
  sessionId: [32m'validation_1761995493720_ku55uk987'[39m,
  totalRecovered: [33m1[39m
}
[2025-11-01T11:11:33.720Z] [INFO] [validation] [GOOGLE_AUTH] loginComGoogle: Fallback para redirect aplicado {
  loginId: [32m'g3'[39m,
  sessionId: [32m'validation_1761995493720_ku55uk987'[39m,
  totalFallbackRedirects: [33m1[39m
}

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mHealth Status[2m > [22m[2mdeve retornar status saudâ”œÃ­vel quando mâ”œÂ®tricas estâ”œÃºo boas
[22m[39m[2025-11-01T11:11:33.720Z] [INFO] [validation] [RACE_CONDITION] fetchUserRole: Condiâ”œÂºâ”œÃºo de corrida prevenida { sessionId: [32m'validation_1761995493720_7wtpeu8tt'[39m, totalPrevented: [33m1[39m }
[2025-11-01T11:11:33.720Z] [INFO] [validation] [FIRESTORE_RECOVERY] getDocumentWithRetry: Conexâ”œÃºo recuperada { sessionId: [32m'validation_1761995493720_7wtpeu8tt'[39m, totalRecovered: [33m1[39m }
[2025-11-01T11:11:33.720Z] [INFO] [validation] [GOOGLE_AUTH] loginComGoogle: Autenticaâ”œÂºâ”œÃºo recuperada { sessionId: [32m'validation_1761995493720_7wtpeu8tt'[39m, totalRecovered: [33m1[39m }

[90mstdout[2m | tests/unit/utils/validationLogger.spec.js[2m > [22m[2mValidationLogger[2m > [22m[2mPersistence[2m > [22m[2mdeve salvar mâ”œÂ®tricas no localStorage
[22m[39m[2025-11-01T11:11:33.722Z] [INFO] [validation] [RACE_CONDITION] fetchUserRole: Condiâ”œÂºâ”œÃºo de corrida prevenida { sessionId: [32m'validation_1761995493722_vkayq7015'[39m, totalPrevented: [33m1[39m }

 [31mÃ”Ã˜Â»[39m tests/unit/utils/validationLogger.spec.js [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 18[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mRace Condition Logging[2m > [22mdeve logar race condition detectada[32m 3[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mRace Condition Logging[2m > [22mdeve logar race condition prevenida[32m 1[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mFirestore Error Logging[2m > [22mdeve logar erro de conexâ”œÃºo Firestore[32m 1[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mFirestore Error Logging[2m > [22mdeve logar recuperaâ”œÂºâ”œÃºo de operaâ”œÂºâ”œÃºo Firestore[32m 0[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mGoogle Auth Logging[2m > [22mdeve logar erro de autenticaâ”œÂºâ”œÃºo Google[32m 1[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mGoogle Auth Logging[2m > [22mdeve logar recuperaâ”œÂºâ”œÃºo de autenticaâ”œÂºâ”œÃºo Google[32m 0[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mGoogle Auth Logging[2m > [22mdeve logar fallback de autenticaâ”œÂºâ”œÃºo Google[32m 0[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mMetrics Calculation[2m > [22mdeve calcular mâ”œÂ®tricas de race conditions[32m 1[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mMetrics Calculation[2m > [22mdeve calcular mâ”œÂ®tricas de Firestore[32m 1[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mMetrics Calculation[2m > [22mdeve calcular mâ”œÂ®tricas de Google Auth[32m 0[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mHealth Status[2m > [22mdeve retornar status saudâ”œÃ­vel quando mâ”œÂ®tricas estâ”œÃºo boas[32m 0[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mHealth Status[2m > [22mdeve retornar status de alerta quando hâ”œÃ­ muitos erros[32m 1[2mms[22m[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mPersistence[2m > [22mdeve salvar mâ”œÂ®tricas no localStorage[32m 1[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m ValidationLogger[2m > [22mPersistence[2m > [22mdeve carregar mâ”œÂ®tricas do localStorage[39m[32m 5[2mms[22m[39m
[31m     Ã”Ã¥Ã† expected +0 to be 1 // Object.is equality[39m
   [32mÃ”Â£Ã´[39m ValidationLogger[2m > [22mEvent System[2m > [22mdeve permitir adicionar e remover event listeners[32m 0[2mms[22m[39m

[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m14 passed[39m[22m[90m (15)[39m
[2m   Start at [22m 08:11:32
[2m   Duration [22m 813ms[2m (transform 52ms, setup 16ms, collect 47ms, tests 18ms, environment 355ms, prepare 168ms)[22m

