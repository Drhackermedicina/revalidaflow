let clean = true;
const frames = [];

/**
 * Schedule a task to run in an animation frame on its own
 * This is useful for heavy tasks that may cause jank if all ran together
 */
export function requestNewFrame(cb) {
  if (!clean || frames.length) {
    frames.push(cb);
    run();
  } else {
    clean = false;
    cb();
    run();
  }
}
let raf = -1;
function run() {
  cancelAnimationFrame(raf);
  raf = requestAnimationFrame(() => {
    const frame = frames.shift();
    if (frame) frame();
    if (frames.length) run();else clean = true;
  });
}
                                            
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVxdWVzdE5ld0ZyYW1lLm1qcyIsIm5hbWVzIjpbImNsZWFuIiwiZnJhbWVzIiwicmVxdWVzdE5ld0ZyYW1lIiwiY2IiLCJsZW5ndGgiLCJwdXNoIiwicnVuIiwicmFmIiwiY2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJmcmFtZSIsInNoaWZ0Il0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVk92ZXJsYXkvcmVxdWVzdE5ld0ZyYW1lLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImxldCBjbGVhbiA9IHRydWVcbmNvbnN0IGZyYW1lcyA9IFtdIGFzIGFueVtdXG5cbi8qKlxuICogU2NoZWR1bGUgYSB0YXNrIHRvIHJ1biBpbiBhbiBhbmltYXRpb24gZnJhbWUgb24gaXRzIG93blxuICogVGhpcyBpcyB1c2VmdWwgZm9yIGhlYXZ5IHRhc2tzIHRoYXQgbWF5IGNhdXNlIGphbmsgaWYgYWxsIHJhbiB0b2dldGhlclxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVxdWVzdE5ld0ZyYW1lIChjYjogKCkgPT4gdm9pZCkge1xuICBpZiAoIWNsZWFuIHx8IGZyYW1lcy5sZW5ndGgpIHtcbiAgICBmcmFtZXMucHVzaChjYilcbiAgICBydW4oKVxuICB9IGVsc2Uge1xuICAgIGNsZWFuID0gZmFsc2VcbiAgICBjYigpXG4gICAgcnVuKClcbiAgfVxufVxuXG5sZXQgcmFmID0gLTFcbmZ1bmN0aW9uIHJ1biAoKSB7XG4gIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHJhZilcbiAgcmFmID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICBjb25zdCBmcmFtZSA9IGZyYW1lcy5zaGlmdCgpXG4gICAgaWYgKGZyYW1lKSBmcmFtZSgpXG5cbiAgICBpZiAoZnJhbWVzLmxlbmd0aCkgcnVuKClcbiAgICBlbHNlIGNsZWFuID0gdHJ1ZVxuICB9KVxufVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxLQUFLLEdBQUcsSUFBSTtBQUNoQixNQUFNQyxNQUFNLEdBQUcsRUFBVzs7QUFFMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLFNBQVNDLGVBQWVBLENBQUVDLEVBQWMsRUFBRTtFQUMvQyxJQUFJLENBQUNILEtBQUssSUFBSUMsTUFBTSxDQUFDRyxNQUFNLEVBQUU7SUFDM0JILE1BQU0sQ0FBQ0ksSUFBSSxDQUFDRixFQUFFLENBQUM7SUFDZkcsR0FBRyxDQUFDLENBQUM7RUFDUCxDQUFDLE1BQU07SUFDTE4sS0FBSyxHQUFHLEtBQUs7SUFDYkcsRUFBRSxDQUFDLENBQUM7SUFDSkcsR0FBRyxDQUFDLENBQUM7RUFDUDtBQUNGO0FBRUEsSUFBSUMsR0FBRyxHQUFHLENBQUMsQ0FBQztBQUNaLFNBQVNELEdBQUdBLENBQUEsRUFBSTtFQUNkRSxvQkFBb0IsQ0FBQ0QsR0FBRyxDQUFDO0VBQ3pCQSxHQUFHLEdBQUdFLHFCQUFxQixDQUFDLE1BQU07SUFDaEMsTUFBTUMsS0FBSyxHQUFHVCxNQUFNLENBQUNVLEtBQUssQ0FBQyxDQUFDO0lBQzVCLElBQUlELEtBQUssRUFBRUEsS0FBSyxDQUFDLENBQUM7SUFFbEIsSUFBSVQsTUFBTSxDQUFDRyxNQUFNLEVBQUVFLEdBQUcsQ0FBQyxDQUFDLE1BQ25CTixLQUFLLEdBQUcsSUFBSTtFQUNuQixDQUFDLENBQUM7QUFDSiIsImlnbm9yZUxpc3QiOltdLCJ4X2dvb2dsZV9pZ25vcmVMaXN0IjpbMF19